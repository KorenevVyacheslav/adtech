# <p align='center'>Итоговый проект. Приложение SF-AdTech </p>

<p align='center'>Выполнено в качестве практического задания на курсе "Продвинутый Backend"</p>

Формулировка ТЗ:
<p> Приложение SF-AdTech — это трекер трафика, созданный для организации взаимодействия компаний (рекламодателей), которые хотят привлечь к себе на сайт посетителей и покупателей (клиентов), и владельцев сайтов (веб-мастеров), на которые люди приходят, например, чтобы почитать новости или пообщаться на форуме.</p>

<p> Рекламодатель создаёт предложение (оффер), определяя URL страницы, на которую он хочет приводить людей. Например, это страница товара, который он хочет продавать. В оффере он также определяет стоимость перехода по ссылке. Скажем, 1 рубль за переход.</p>

<p> Веб-мастера в системе видят создаваемые офферы, подписываются на них, после чего система выдаёт им специальные ссылки, которые они должны разместить в любом виде у себя на ресурсе. Ссылка эта ведёт не на целевой URL, а на систему-редиректор, которая фиксирует переход, а затем перенаправляет клиента на страницу сайта рекламодателя. </p>

<p> Описание приложения: </p>

+ При входе в приложение пользователь должен войти по логину и паролю либо пройти регистрацию.
+ В качестве логина выступает email пользователя.
+ Предусмотрено три роли для пользователей:
  - администратор;
  - рекламодатель;
  - веб-мастер.
+ При регистрации пользователь может выбрать роль: вебмастер или рекламодатель
+ Администратор может производить следующие действия:
    - авторизовывать на работу новых рекламодателей и веб-мастеров;
    - отключать их;
    - контролировать общий доход системы;
    - выводить статистику по выданным ссылкам, переходам, отказам (когда веб-мастер попытался перенаправить на оффер, на который он не подписан);
    - менять логин и пароль в личном кабинете.

+ Рабочий стол администратора:
  ![alt text](./resources/assets/admin_work.png)
+ Общая статистика по сиcтеме:
  ![alt text](./resources/assets/admin_statistic.png)
+ Личный кабинет:
  ![alt text](./resources/assets/dashboard.png)

+ Рекламодатель может производить следующие действия:
    - зарегистрироваться в системе;
    - авторизоваться в системе;
    - посмотреть список созданных им офферов;
    - увидеть кол-во веб-мастеров, подписанных на каждый из офферов;
    - создать новый оффер:
      - указать имя оффера;
      - указать стоимость перехода;
      - указать целевой URL;
      - определить темы сайта;
    - деактивировать оффер;
    - посмотреть расходы и кол-во переходов по офферу в разрезах:
      - день;
      - месяц;
      - год;
    - менять логин и пароль в личном кабинете.

+ Рабочий стол рекламодателя:
  ![alt text](./resources/assets/advertiser_work1.png)
  ![alt text](./resources/assets/advertiser_work2.png)
+ Страница создания рекламодателя:
  ![alt text](./resources/assets/advertiser_create.png)
+ Страница статистики рекламодателя:
  ![alt text](./resources/assets/advertiser_statistic.png)

+ Вебмастер может производить следующие действия:
    - зарегистрироваться в системе;
    - авторизоваться в системе;
    - посмотреть список офферов, на которые он подписан;
    - подписаться на новый оффер и получить ссылку системы;
    - отписаться от оффера;
    - посмотреть расходы и кол-во переходов по офферу в разрезах:
      - день;
      - месяц;
      - год;
    - менять логин и пароль в личном кабинете.

+ Рабочий стол вебмастера:
  ![alt text](./resources/assets/webmaster_work1.png)
  ![alt text](./resources/assets/webmaster_work2.png)
+ Страница статистики вебмастера:
  ![alt text](./resources/assets/webmaster_statistic.png)

<p> Маршруты API. </p>  

+ Для получения JWT токена используется маршрут (ключи email  и password, метод post)
    http://localhost:8000/api/login
    ![alt text](./resources/assets/api_login.png)

+ Все остальные маршруты API реализованы только для пользователей с правами вебмастера.
+ Для получения перечня доступных для подписи офферов для текущего вебмастера используется маршрут  
    http://localhost:8000/api/offers/allowed
    ![alt text](./resources/assets/api_offers_allowed.png)
+ Для получения перечня офферов на которые подписан текущий пользователь используется маршрут  
    http://localhost:8000/api/offers
    ![alt text](./resources/assets/api_offers.png)
+ Для подписки на доступный оффер используется маршрут 
    http://localhost:8000/api/offers/allowed/{id} 
    ![alt text](./resources/assets/api_offers_id.png)

+ Маршрут API обработки ссылок /link/{offer_id}/{user_id}', [LinkController::class, 'edit'];


#### Дополнительно
+ Интерфейс приложения реализован на Bootstrap 5.
+ Обмен между frontend и backend релизован на AJAX.
+ Все формы отправки используют CSRF-токен для защиты от CSRF аттак.
+ Защита от SQL-инъекций обеспечивается ORM Eloquent.


## Используемые технологии

* Laravel 10.48

* ORM Eloquent

* PHP 8.1.8

* Bootstrap 5.0

* JS


## Как открыть/запустить

1. Клонировать проект к себе на ПК
<pre> git clone https://github.com/KorenevVyacheslav/adtech 
</pre>
2. В файле *.env переопределить константы DB_CONNECTION, DB_HOST, DB_PORT, DB_DATABASE для подключения к вашей БД.
3. Выполнить команду
<pre> composer update 
</pre>
4. Выполнить команду для создания таблиц
<pre> php artisan migrate 
</pre>
5. Раскомментировать содержимое файла DatabaseSeeder.php. Для наполнения таблиц выполнить команду
<pre> php artisan db:seed
</pre>

Пароль у всех пользователей: 12345678

## Таблицы

+ users - пользователи
+ topics - темы офферов
+ offers - офферы
+ offers_user - связи между офферами и пользователями
+ clicks - связи между переходами пользовалей по ссылкам и офферам

![alt text](./resources/assets/tables.png)

